# MVP ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å¯¾å¿œæ–¹é‡

## ğŸ“‹ æ¦‚è¦

MVPãƒ†ã‚¹ãƒˆã§å¾—ã‚‰ã‚ŒãŸãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«å¯¾ã™ã‚‹æŠ€è¡“çš„å¯¾å¿œæ–¹é‡ã‚’ã¾ã¨ã‚ãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€‚

**ä½œæˆæ—¥**: 2026å¹´1æœˆ27æ—¥  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†ï¼ˆ2026å¹´1æœˆ28æ—¥ï¼‰

---

## ğŸ“Œ èª²é¡Œâ‘ : AIã®å›ç­”ç²¾åº¦å•é¡Œ âœ… å®Ÿè£…å®Œäº†

### å•é¡Œã®è©³ç´°

ç¾çŠ¶ã®ã‚ã£ã¡ã‚ƒã‚“AIã¯ã€æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã«ãªã„æƒ…å ±ã«ã¤ã„ã¦ã‚‚ã€ŒçŸ¥ã£ã¦ã„ã‚‹ãµã‚Šã€ã‚’ã—ã¦å›ç­”ã—ã¦ã—ã¾ã†ã€‚

**ä¾‹**: ã€Œã‚µã‚¤ã‚¼ãƒªãƒ¤ã§å¥½ããªãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’30å€‹æ•™ãˆã¦ã€ã¨èã‹ã‚Œã‚‹ã¨ã€å®Ÿéš›ã®çŸ³å·æ•¦å¤§ã®å¥½ã¿ã§ã¯ãªã„æƒ…å ±ã‚’ç”Ÿæˆã—ã¦ã—ã¾ã†ã€‚

### æœ›ã¾ã—ã„å‹•ä½œ

æ•™å¸«ãƒ‡ãƒ¼ã‚¿ã«ãªã„æƒ…å ±ã‚’æ±‚ã‚ã‚‰ã‚ŒãŸå ´åˆ:
```
ã€Œã™ã¿ã¾ã›ã‚“ã€ãã®æƒ…å ±ã¯æŒã£ã¦ã„ãªã„ã‚“ã§ã™ï¿½
 â—‹â—‹ã«ã¤ã„ã¦ãªã‚‰ãŠè©±ã—ã§ãã¾ã™ã‚ˆï¼ã€
```

### å®Ÿè£…å†…å®¹ï¼ˆ2026å¹´1æœˆ28æ—¥å®Œäº†ï¼‰

#### 2æ®µéšåˆ¤å®šã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…

1. **çŸ¥è­˜åˆ¤å®šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**: `lib/openai/knowledge-check.ts`
   - è³ªå•ãŒãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã§å›ç­”å¯èƒ½ã‹ã‚’AIãŒäº‹å‰åˆ¤å®š
   - åˆ¤å®šçµæœ: `canAnswer`, `confidence`, `reason`, `shouldRecord`
   - å›ç­”ä¸å¯ã®å ´åˆã¯æœªå›ç­”è³ªå•ã¨ã—ã¦è‡ªå‹•è¨˜éŒ²

2. **ãƒãƒ£ãƒƒãƒˆAPIçµ±åˆ**: `app/api/chat/route.ts`
   - ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å›ç­”å‰ã«çŸ¥è­˜åˆ¤å®šã‚’å®Ÿè¡Œ
   - å›ç­”ä¸å¯ã®å ´åˆã¯å®šå‹æ–‡ã‚’è¿”ã™
   - æœªå›ç­”è³ªå•ã‚’DBã«è¨˜éŒ²ï¼ˆå­¦ç¿’ãƒ‡ãƒ¼ã‚¿åé›†ï¼‰

3. **å¿œç­”ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**:
   ```typescript
   // å›ç­”ä¸å¯æ™‚ã®å¿œç­”
   "ã™ã¿ã¾ã›ã‚“ã€ãã®æƒ…å ±ã¯æŒã£ã¦ã„ãªã„ã‚“ã§ã™ğŸ˜…"
   ```

#### ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ä¸€è¦§
- `lib/openai/knowledge-check.ts` - æ–°è¦ä½œæˆ
- `lib/openai/index.ts` - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¿½åŠ 
- `app/api/chat/route.ts` - 2æ®µéšåˆ¤å®šã‚’çµ±åˆ

---

## ğŸ“Œ èª²é¡Œâ‘¡: æœªå›ç­”è³ªå•ã®å­¦ç¿’æ©Ÿèƒ½ âœ… å®Ÿè£…å®Œäº†
- ä¸Šè¨˜ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã«è¨˜è¼‰ã•ã‚ŒãŸæƒ…å ±
- æŠ€è¡“ãƒ»é–‹ç™ºã«é–¢ã™ã‚‹ä¸€èˆ¬çš„ãªè©±é¡Œ
- ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚µã‚¤ãƒˆã®æ©Ÿèƒ½èª¬æ˜
- ãŠä»•äº‹ã®ç›¸è«‡

ã€å›ç­”ã‚’æ§ãˆã‚‹ç¯„å›²ã€‘
- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã«ãªã„å€‹äººçš„ãªå¥½ã¿ï¼ˆè©³ç´°ãªé£Ÿã¹ç‰©ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãªã©ï¼‰
- å®Ÿéš›ã«ä½“é¨“ã—ã¦ã„ãªã„åº—èˆ—ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã®è©•ä¾¡
- æ”¿æ²»ãƒ»å®—æ•™ãƒ»ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãªè©±é¡Œ
`;
```

#### æ–¹æ³•2: RAGï¼ˆæ¤œç´¢æ‹¡å¼µç”Ÿæˆï¼‰ã®å°å…¥ï¼ˆä¸­æœŸå¯¾å¿œï¼‰

ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ ¼ç´ã—ã€è³ªå•ã«é–¢é€£ã™ã‚‹æƒ…å ±ãŒå­˜åœ¨ã™ã‚‹ã‹ã‚’äº‹å‰ãƒã‚§ãƒƒã‚¯:

```typescript
// lib/ai/rag-check.ts

import { createClient } from '@supabase/supabase-js';

interface RelevanceResult {
  hasRelevantData: boolean;
  relevantTopics: string[];
  confidence: number;
}

export async function checkDataRelevance(question: string): Promise<RelevanceResult> {
  const supabase = createClient(process.env.SUPABASE_URL!, process.env.SUPABASE_KEY!);
  
  // è³ªå•ã®åŸ‹ã‚è¾¼ã¿ãƒ™ã‚¯ãƒˆãƒ«ã‚’ç”Ÿæˆ
  const embedding = await generateEmbedding(question);
  
  // ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã§é–¢é€£ãƒ‡ãƒ¼ã‚¿ã‚’æ¢ã™
  const { data: matches } = await supabase.rpc('match_profile_data', {
    query_embedding: embedding,
    match_threshold: 0.7,  // é¡ä¼¼åº¦70%ä»¥ä¸Š
    match_count: 5
  });
  
  if (!matches || matches.length === 0) {
    return {
      hasRelevantData: false,
      relevantTopics: [],
      confidence: 0
    };
  }
  
  return {
    hasRelevantData: true,
    relevantTopics: matches.map(m => m.topic),
    confidence: matches[0].similarity
  };
}

// ãƒãƒ£ãƒƒãƒˆAPIå†…ã§ã®ä½¿ç”¨
export async function handleChat(message: string) {
  const relevance = await checkDataRelevance(message);
  
  if (!relevance.hasRelevantData) {
    // é–¢é€£ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã®ç‰¹åˆ¥ãªå‡¦ç†
    return generateFallbackResponse(message, relevance);
  }
  
  // é€šå¸¸ã®å›ç­”ç”Ÿæˆ
  return generateResponse(message, relevance.relevantTopics);
}
```

#### æ–¹æ³•3: 2æ®µéšå›ç­”ã‚·ã‚¹ãƒ†ãƒ ï¼ˆæ¨å¥¨ãƒ»é«˜ç²¾åº¦ï¼‰

1. **åˆ¤å®šãƒ•ã‚§ãƒ¼ã‚º**: è³ªå•ãŒãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç¯„å›²å†…ã‹ã‚’åˆ¤å®š
2. **å›ç­”ãƒ•ã‚§ãƒ¼ã‚º**: åˆ¤å®šçµæœã«åŸºã¥ã„ã¦å›ç­”

```typescript
// lib/ai/two-phase-response.ts

async function generateResponse(userMessage: string) {
  // Phase 1: å›ç­”å¯èƒ½æ€§ã®åˆ¤å®š
  const judgmentPrompt = `
    ä»¥ä¸‹ã®è³ªå•ãŒã€ä¸ãˆã‚‰ã‚ŒãŸãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã§å›ç­”å¯èƒ½ã‹ã‚’åˆ¤å®šã—ã¦ãã ã•ã„ã€‚
    
    ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±:
    ${profileData}
    
    è³ªå•: ${userMessage}
    
    å›ç­”å½¢å¼ï¼ˆJSONï¼‰:
    {
      "canAnswer": true/false,
      "reason": "åˆ¤å®šç†ç”±",
      "suggestedTopic": "ä»£ã‚ã‚Šã«ææ¡ˆã§ãã‚‹è©±é¡Œï¼ˆå›ç­”ä¸å¯ã®å ´åˆï¼‰"
    }
  `;
  
  const judgment = await openai.chat.completions.create({
    model: "gpt-4o-mini",
    messages: [{ role: "user", content: judgmentPrompt }],
    response_format: { type: "json_object" }
  });
  
  const result = JSON.parse(judgment.choices[0].message.content);
  
  // Phase 2: åˆ¤å®šã«åŸºã¥ãå›ç­”ç”Ÿæˆ
  if (!result.canAnswer) {
    return `ã™ã¿ã¾ã›ã‚“ã€${result.reason}ã«ã¤ã„ã¦ã¯è©³ã—ã„æƒ…å ±ã‚’æŒã£ã¦ã„ãªã„ã‚“ã§ã™ã€‚
            ${result.suggestedTopic}ã«ã¤ã„ã¦ãªã‚‰ãŠè©±ã§ãã¾ã™ã‚ˆï¼ğŸ˜Š`;
  }
  
  // é€šå¸¸ã®å›ç­”ç”Ÿæˆ
  return await generateNormalResponse(userMessage);
}
```

### æ¨å¥¨å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

1. **å³æ™‚**: ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å¼·åŒ–ï¼ˆ1-2æ™‚é–“ï¼‰
2. **çŸ­æœŸ**: 2æ®µéšå›ç­”ã‚·ã‚¹ãƒ†ãƒ ã®å°å…¥ï¼ˆ1-2æ—¥ï¼‰
3. **ä¸­æœŸ**: RAGã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ï¼ˆ1-2é€±é–“ï¼‰

### ã‚³ã‚¹ãƒˆå½±éŸ¿

- 2æ®µéšå›ç­”: APIå‘¼ã³å‡ºã—ãŒ2å€ â†’ ã‚³ã‚¹ãƒˆç´„2å€
- RAG: ãƒ™ã‚¯ãƒˆãƒ«DBè¿½åŠ  â†’ æœˆ$10-30ç¨‹åº¦

---

## ğŸ“Œ èª²é¡Œâ‘¡: ã‚¤ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼è³ªå•ã®å­¦ç¿’æ©Ÿèƒ½ âœ… å®Ÿè£…å®Œäº†

### å•é¡Œã®è©³ç´°

å›ç­”ã§ããªã‹ã£ãŸè³ªå•ï¼ˆã‚¤ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼è³ªå•ï¼‰ã‚’è¨˜éŒ²ã—ã€å¾Œã‹ã‚‰adminç”»é¢ã§å›ç­”ã‚’ç”¨æ„ã—ãŸã„ã€‚

### å®Ÿè£…å†…å®¹ï¼ˆ2026å¹´1æœˆ28æ—¥å®Œäº†ï¼‰

#### 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ

`supabase/migrations/006_unanswered_questions.sql`:
- `unanswered_questions` ãƒ†ãƒ¼ãƒ–ãƒ«
- è³ªå•ã€å›æ•°ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€å›ç­”ã‚’ç®¡ç†
- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«é€£æºæ©Ÿèƒ½ä»˜ã

#### 2. ç®¡ç†ç”»é¢UIå®Ÿè£…

`app/admin/unanswered-questions/page.tsx`:
- æœªå›ç­”è³ªå•ã®ä¸€è¦§è¡¨ç¤º
- è³ªå•å›æ•°é †/æœ€æ–°é †ã§ã‚½ãƒ¼ãƒˆ
- å›ç­”ç™»éŒ²ãƒ¢ãƒ¼ãƒ€ãƒ«
- å‹•çš„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã¸ã®è‡ªå‹•è¿½åŠ æ©Ÿèƒ½
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†ï¼ˆæœªå¯¾å¿œ/å›ç­”æ¸ˆã¿/ç„¡è¦–ï¼‰

#### 3. APIå®Ÿè£…

`app/api/admin/unanswered-questions/route.ts`:
- GET: è³ªå•ä¸€è¦§å–å¾—ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ»ã‚½ãƒ¼ãƒˆå¯¾å¿œï¼‰
- POST: å›ç­”ç™»éŒ² + ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è‡ªå‹•è¿½åŠ 
- PATCH: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°

#### ç”»é¢ã‚¤ãƒ¡ãƒ¼ã‚¸

```
æœªå›ç­”ã®è³ªå• (12ä»¶)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
è³ªå•: ã€Œã‚µã‚¤ã‚¼ãƒªãƒ¤ã§å¥½ããªãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯ï¼Ÿã€
å›æ•°: 3å› | åˆå›: 2026/01/25 | æœ€æ–°: 2026/01/28
[å›ç­”ã‚’ç™»éŒ²] [ç„¡è¦–]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

#### ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ä¸€è¦§
- `supabase/migrations/006_unanswered_questions.sql` - æ–°è¦ä½œæˆ
- `types/database.types.ts` - å‹å®šç¾©è¿½åŠ 
- `app/api/admin/unanswered-questions/route.ts` - æ–°è¦ä½œæˆ
- `app/admin/unanswered-questions/page.tsx` - æ–°è¦ä½œæˆ
- `components/admin/Sidebar.tsx` - ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ 
      category,
      status: 'answered',
      answered_at: new Date().toISOString(),
      updated_at: new Date().toISOString()
    })
    .eq('id', id);
  
  if (error) throw error;
  
  // å‹•çš„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã«è¿½åŠ ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  if (answer) {
    await addToDynamicProfile(category, answer);
  }
  
  return NextResponse.json({ success: true });
}
```

#### ãƒãƒ£ãƒƒãƒˆAPIã§ã®è¨˜éŒ²

```typescript
// lib/ai/chat-handler.ts ã®ä¿®æ­£

async function handleChat(message: string, conversationId: string) {
  const relevance = await checkDataRelevance(message);
  
  if (!relevance.hasRelevantData) {
    // ã‚¤ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼è³ªå•ã¨ã—ã¦è¨˜éŒ²
    await recordUnansweredQuestion(message, conversationId);
    
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å›ç­”ã‚’è¿”ã™
    return generateFallbackResponse(message);
  }
  
  return generateNormalResponse(message);
}

async function recordUnansweredQuestion(question: string, conversationId: string) {
  const supabase = await createAdminClient();
  
  // é¡ä¼¼ã®è³ªå•ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
  const { data: existing } = await supabase
    .from('unanswered_questions')
    .select('id, frequency')
    .ilike('question', `%${extractKeywords(question)}%`)
    .single();
  
  if (existing) {
    // é »åº¦ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
    await supabase
      .from('unanswered_questions')
      .update({ frequency: existing.frequency + 1 })
      .eq('id', existing.id);
  } else {
    // æ–°è¦ç™»éŒ²
    await supabase
      .from('unanswered_questions')
      .insert({
        question,
        conversation_id: conversationId,
        category: await categorizeQuestion(question)
      });
  }
}
```

#### Adminç”»é¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
// app/admin/unanswered-questions/page.tsx

export default async function UnansweredQuestionsPage() {
  return (
    <div>
      <PageHeader
        title="æœªå›ç­”ã®è³ªå•"
        description="AIãŒå›ç­”ã§ããªã‹ã£ãŸè³ªå•ã‚’ç¢ºèªã—ã€å›ç­”ã‚’è¿½åŠ ã§ãã¾ã™"
      />
      
      <div className="space-y-4">
        {/* è³ªå•ãƒªã‚¹ãƒˆ */}
        <UnansweredQuestionsList />
        
        {/* å›ç­”è¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ« */}
        <AnswerModal />
      </div>
    </div>
  );
}
```

#### å‹•çš„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã¨ã®é€£æº

å›ç­”ã‚’ç”¨æ„ã—ãŸè³ªå•ã¯ã€è‡ªå‹•çš„ã«ã€Œå‹•çš„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã€ã«è¿½åŠ :

```typescript
async function addToDynamicProfile(category: string, answer: string) {
  const supabase = await createAdminClient();
  
  // æ—¢å­˜ã®ã‚«ãƒ†ã‚´ãƒªãŒã‚ã‚‹ã‹ç¢ºèª
  const { data: existing } = await supabase
    .from('profile_data')
    .select('id, content')
    .eq('category', category)
    .single();
  
  if (existing) {
    // æ—¢å­˜ã‚«ãƒ†ã‚´ãƒªã«è¿½è¨˜
    await supabase
      .from('profile_data')
      .update({
        content: existing.content + '\n' + answer,
        updated_at: new Date().toISOString()
      })
      .eq('id', existing.id);
  } else {
    // æ–°è¦ã‚«ãƒ†ã‚´ãƒªã¨ã—ã¦è¿½åŠ 
    await supabase
      .from('profile_data')
      .insert({
        category,
        content: answer,
        is_active: true,
        source: 'learning' // å­¦ç¿’ã«ã‚ˆã‚Šè¿½åŠ ã•ã‚ŒãŸã“ã¨ã‚’ç¤ºã™
      });
  }
}
```

### æ¨å¥¨å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

1. **DBä½œæˆ**: unanswered_questionsãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆï¼ˆ30åˆ†ï¼‰
2. **è¨˜éŒ²æ©Ÿèƒ½**: ãƒãƒ£ãƒƒãƒˆAPIã§ã®æœªå›ç­”è³ªå•è¨˜éŒ²ï¼ˆ2æ™‚é–“ï¼‰
3. **ç®¡ç†ç”»é¢**: æœªå›ç­”è³ªå•ä¸€è¦§ãƒ»å›ç­”è¿½åŠ UIï¼ˆ4æ™‚é–“ï¼‰
4. **é€£æºæ©Ÿèƒ½**: å‹•çš„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã¸ã®è‡ªå‹•è¿½åŠ ï¼ˆ2æ™‚é–“ï¼‰

### UIã‚¤ãƒ¡ãƒ¼ã‚¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœªå›ç­”ã®è³ªå•                                    [ä¿ç•™ä¸­ â–¼]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“ ã€Œã‚µã‚¤ã‚¼ãƒªãƒ¤ã§å¥½ããªãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’30å€‹æ•™ãˆã¦ã€      â”‚ â”‚
â”‚ â”‚ ã‚«ãƒ†ã‚´ãƒª: é£Ÿã¹ç‰©  |  å‡ºç¾å›æ•°: 5å›  |  2026/01/27   â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ å›ç­”ã‚’è¿½åŠ ...                                  â”‚   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                           [ç„¡è¦–ã™ã‚‹] [å›ç­”ã‚’ä¿å­˜]   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“ ã€Œå¥½ããªã‚¢ãƒ‹ãƒ¡ã¯ä½•ã§ã™ã‹ï¼Ÿã€                    â”‚ â”‚
â”‚ â”‚ ã‚«ãƒ†ã‚´ãƒª: è¶£å‘³   |  å‡ºç¾å›æ•°: 3å›  |  2026/01/26   â”‚ â”‚
â”‚ â”‚                           [ç„¡è¦–ã™ã‚‹] [å›ç­”ã‚’è¿½åŠ ]   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Œ èª²é¡Œâ‘¢: ç”»åƒç®¡ç†æ©Ÿèƒ½ãŒå‹•ä½œã—ãªã„ âœ… å®Ÿè£…å®Œäº†

### å•é¡Œã®è©³ç´°

ç”»åƒç®¡ç†ç”»é¢ã§ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚ã€ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨æ¶ˆãˆã¦ã—ã¾ã†ã€‚

### åŸå› 

APIãŒStorageã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã ã‘ã§ã€`profile_images`ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜ã—ã¦ã„ãªã‹ã£ãŸã€‚

### å®Ÿè£…å†…å®¹ï¼ˆ2026å¹´1æœˆ28æ—¥å®Œäº†ï¼‰

#### 1. APIä¿®æ­£

`app/api/admin/images/route.ts`:
- Storageã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¾Œã€`profile_images`ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚‚ä¿å­˜ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£
- ã‚«ãƒ©ãƒ åã‚’ `url` â†’ `image_url` ã«çµ±ä¸€
- `storage_path` ã‚«ãƒ©ãƒ ã‚’è¿½åŠ 

#### 2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¿®æ­£

`app/admin/images/page.tsx`:
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ `image_url`, `alt_text` ã«åˆã‚ã›ã¦ä¿®æ­£
- APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æ­£è¦åŒ–å‡¦ç†ã‚’è¿½åŠ 

#### 3. å‹å®šç¾©ä¿®æ­£

`types/database.types.ts`:
- `ProfileImage` å‹ã®ã‚«ãƒ©ãƒ åã‚’æ­£ã—ãä¿®æ­£

#### 4. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¿½åŠ 

`supabase/migrations/005_update_profile_images.sql`:
- ã‚«ãƒ©ãƒ åå¤‰æ›´: `url` â†’ `image_url`
- `storage_path` ã‚«ãƒ©ãƒ è¿½åŠ 
- RLSãƒãƒªã‚·ãƒ¼è¨­å®š

#### 5. ãƒãƒ£ãƒƒãƒˆã‚¢ãƒã‚¿ãƒ¼é€£æº

- `app/api/chat/route.ts`: ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã« `avatarUrl` ã‚’è¿½åŠ 
- `components/chat/ChatContainer.tsx`: Messageå‹ã« `avatarUrl` ã‚’è¿½åŠ 
- `lib/profile/get-avatar.ts`: ã‚«ãƒ©ãƒ åã‚’ä¿®æ­£

#### ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ä¸€è¦§
- `app/api/admin/images/route.ts` - DBä¿å­˜ã‚’è¿½åŠ 
- `app/admin/images/page.tsx` - ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ä¿®æ­£
- `types/database.types.ts` - å‹å®šç¾©ä¿®æ­£
- `lib/profile/get-avatar.ts` - ã‚«ãƒ©ãƒ åä¿®æ­£
- `supabase/migrations/005_update_profile_images.sql` - æ–°è¦ä½œæˆ
- `app/api/chat/route.ts` - ã‚¢ãƒã‚¿ãƒ¼URLè¿½åŠ 
- `components/chat/ChatContainer.tsx` - Messageå‹ã«avatarUrlè¿½åŠ 
2. SQLã‚¨ãƒ‡ã‚£ã‚¿ã§ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
3. APIã‚³ãƒ¼ãƒ‰ã®ä¿®æ­£ï¼ˆDBä¿å­˜ã‚’è¿½åŠ ï¼‰

---

## ğŸ“Š å®Ÿè£…å„ªå…ˆåº¦

| èª²é¡Œ | é‡è¦åº¦ | ç·Šæ€¥åº¦ | å·¥æ•° | æ¨å¥¨å„ªå…ˆåº¦ |
|------|--------|--------|------|------------|
| â‘ AIç²¾åº¦ | é«˜ | é«˜ | ä¸­ | **1ä½** |
| â‘¢ç”»åƒç®¡ç† | ä¸­ | é«˜ | ä½ | **2ä½** |
| â‘¡å­¦ç¿’æ©Ÿèƒ½ | é«˜ | ä¸­ | é«˜ | **3ä½** |

### æ¨å¥¨å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

```
Week 1:
  Day 1-2: â‘ AIç²¾åº¦æ”¹å–„ï¼ˆã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå¼·åŒ– + 2æ®µéšå›ç­”ï¼‰
  Day 3:   â‘¢ç”»åƒç®¡ç†ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…
  
Week 2:
  Day 1-3: â‘¡ã‚¤ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼è³ªå•è¨˜éŒ²æ©Ÿèƒ½
  Day 4-5: â‘¡ç®¡ç†ç”»é¢UI + å‹•çš„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«é€£æº
  
Week 3:
  Day 1-2: å…¨ä½“ãƒ†ã‚¹ãƒˆãƒ»èª¿æ•´
  Day 3:   æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤
```

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆ](./system-prompt-design.md)
- [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ](./database-schema.md)
- [APIè¨­è¨ˆ](./api-design.md)

---

**æœ€çµ‚æ›´æ–°**: 2026å¹´1æœˆ27æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**ä½œæˆè€…**: çŸ³å·æ•¦å¤§
